on:
  push:
    branches:
    - main
name: ğŸš€ Validate and deploy website on push
jobs:
  web-flow:
    name: Website Build, Validate, and Deploy
    runs-on: ubuntu-latest
    steps:
      - name: ğŸšš Get latest code
        uses: actions/checkout@v6
      - name: Set up Node.js
        uses: actions/setup-node@v6
        with:
          node-version: '24'  
      - name: Install Minifier Tools
        run: npm install terser html-minifier csso-cli
      - name: Install Validation Tools
        run: npm install htmlhint eslint stylelint stylelint-config-standard
      - name: âœ… Validating JavaScript
        run: npx eslint *.js
      - name: âœ… Validating HTML
        run: npx htmlhint *.html
      - name: âœ… Validating CSS
        run: npx stylelint *.css
      - name: ğŸ“ Minifying HTML
        run: npx html-minifier --collapse-whitespace --remove-comments --minify-css true --minify-js true -o index.html index.html
      - name: ğŸ“ Minifying JavaScript
        run: npx terser index.js -o index.js --compress --mangle --comments "/eslint/"
      - name: ğŸ“ Minifying CSS
        run: npx csso-cli index.css --output index.css
      - name: âœ… Validate minified JavaScript
        run: npx eslint *.js
      - name: âœ… Validate minified HTML
        run: npx htmlhint *.html
      - name: âœ… Validate minified CSS
        run: npx stylelint *.css
      - name: ğŸ“‚ Sync files
        uses: SamKirkland/FTP-Deploy-Action@v4.3.6
        with:
          server: ftp.cluster010.hosting.ovh.net
          username: zrenard
          password: ${{ secrets.ftp_password }}
          server-dir: /www/nanardi/
          exclude: |
            .git*
            .git*/**
            node_modules/**
            *.yml
            *.yaml
            README.md
            *.json
            *.mjj
